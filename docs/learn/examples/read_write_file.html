[%- page.import({
    title => 'Reading and writing a file with Perl',
    section => 'examples',
}) -%]

<h4>Writing to a file</h4>
[% WRAPPER code_chunk -%]
[% INCLUDE "examples/script_head.html" -%]
use Path::Class;

my $dir = dir("/tmp"); # /tmp

my $file = $dir->file("file.txt"); # /tmp/file.txt

# Get a file_handle (IO::File object) you can write to
my $file_handle = $file->openw() 
    or die "Can't write $file: $!";

my @list = ('a', 'list', 'of', 'lines');

foreach my $line ( @list ) {
    # Add the line to the file
    $file_handle->print($line . "\n");
}

[%- END %]

<h4>Appending to a file</h4>
[% WRAPPER code_chunk -%]
# As above but use open('>>') instead of openw()
my $file_handle = $file->open('>>') 
    or die "Can't write $file: $!";
[%- END %]

<h4>Reading a file</h4>
[% WRAPPER code_chunk -%]
[% INCLUDE "examples/script_head.html" -%]
use Path::Class;

my $dir = dir("/tmp"); # /tmp

my $file = $dir->file("file.txt");

# Read in the entire contents of a file
my $content = $file->slurp();

# openr() returns an IO::File object to read from
my $file_handle = $file->openr() 
    or die "Can't read $file: $!";

# Read in line at a time
while( my $line = $file_handle->getline() ) {
        print $line;
}

[%- END %]

<p>
[% PROCESS cpan_link module=>'Path::Class' %] makes working with
directories and files clean and easy to do. Try to work
with file() or dir() objects throughout your code, but remember if
you are calling other Perl modules you will often need to convert the
object to a string using 'stringify':
[% WRAPPER code_chunk -%]
$file->stringify();
$dir->stringify();
[% END %]

</p>
