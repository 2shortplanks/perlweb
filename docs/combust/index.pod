
=head1 Combust 

Combust is the web framework / content management system for geeks
that we use at perl.org.


=head2 Features

In brief

=over 4 

=item Subversion backed

=item MVC architected

=item Clever integrated utility modules

Dealing with caching and cookies was never any easier.

=item Automatic POD formatting

We write pod.  Web browsers read HTML.

=item Supports staging areas with branches and other goodies

=item Easy to install a local development version

=back


=head2 Getting started

=head3 Requirements

You need Apache 1.3.x with mod_perl 1.2.x, Perl 5.8 and the CPAN
modules from the following section.  Combust can be installed and run
as any user. (As long as it doesn't bind to port 80.)  We reccomend
using a front-end Apache2 proxy on port 80.

If the sites you work on use caching you will also need to run a
MySQL server.

The scripts are currently hardcoded to find the Apache with mod_perl
statically linked in /home/perl/apache1/bin/httpd and perl in
/home/perl/bin/perl.

If you run a Linux installation not unlike RedHat 7.x you might be
able to use our perl/apache/subversion installation from perl.org.
Contact ask@perl.org or robert@perl.org for rsync instructions.

=head3 Install modules from CPAN

/home/perl/bin/perl -MCPAN -e shell

C<install Date::Parse DBI Exception::Class Bundle::LWP Text::Template>

C<install Config::Simple Mail::Internet Time::HiRes>

C<install URI::Find DBD::mysql Template Apache::Reload>

We will make a Bundle to be installed at some point.  

=head3 Apache2 Proxy setup

The most common mod_perl setup is to have a light proxy in front of
the mod_perl setup.  Using Apache 2.x for the proxy is somewhat
simpler than using 1.3 because 2.0 has the "ProxyPreserveHost"
feature.  B<If for development you just want to run Combust on a high
port and not have it available via port 80 you can skip the proxy
setup.>

Add something like the following to your Apache 2.0 httpd.conf file:

  ProxyVia On
  ProxyPreserveHost On

  <VirtualHost *>
    ServerName c.askask.com
    ServerAlias *.c.askask.com
    RewriteEngine on
    RewriteRule (.*) http://localhost:8225$1 [P]
  </VirtualHost>

This example is what I use on my development server where all the
sites are configured under the c.askask.com domain and the Combust
server runs on port 8225 (configured in combust.conf).


=head3 Create a user and get the goods

  adduser combust
  su - combust
  rm .bashrc
  svn co http://svn.develooper.com/perl.org/backend/trunk .
  svn co http://svn.develooper.com/perl.org/docs    

  # setup configuration from the sample conf
  cp combust.conf.sample combust.conf
  emacs combust.conf  

  ./bin/run_httpd

You might want to put bin/cron_hourly into the combust users crontab.
In any case then it should be executed at least once.

=head2 Use a different document root on the fly

Adding "?root=user/path" to a url will make Combust use the
~user/docs/path as the document root when loading templates.  For
example then I'd use

  http://site.c.askask.com/?root=ask/live

to load templates from ~ask/docs/live on my development server. 

Combust sets a cookie to keep using the new root until told otherwise
(by for example setting root=/ to go back to the default).


=head2 How to add another site

=over 4

=item Add to combust.conf

Add a new section like the following to $CBROOT/combust.conf

  sites = newsite, oldsite, othersite 

  [newsite]
  servername = newsite.example.com


=item Add a section to httpd.tmpl

See the existing configurations there for examples. You most likely
want to set it up to use the Combust::Control::Basic controller.

=item Add documents

Add the directory docs/live/newsite/ and drop your documents in there.
Setup a default page style etc in docs/live/newsite/tpl/defaults.  See
some of the old site configurations for examples.

=back

=head2 Copyright

Combust is Copyright 2003 Ask Bjoern Hansen.  See the LICENSE file.
 

