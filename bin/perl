#!/bin/sh
if [ -z $CBROOT ]; then
  echo CBROOT environment variable not set 1>&2
  exit 255
fi

# funny bash syntax for setting ROOT to one or the other if the one isn't set
ROOT=${CBROOTLOCAL:-$CBROOT}

CONFIGFILE=${CBCONFIG:-$ROOT/combust.conf}

if [ ! -f $CONFIGFILE ]; then
  echo Could not find configuration file $CONFIGFILE 1>&2
  exit 255
fi

MYPERL=`grep ^perl $CONFIGFILE | cut -d= -f2 | sed 's/[[:space:]]//g'`

if [ -z $MYPERL ]; then
  echo Could not find "perl =" line in the combust.conf 1>&2
  exit 255
fi

if [ ! -z $CBROOTLOCAL ]; then
  LLIB=-I$CBROOTLOCAL/lib
fi

exec $MYPERL -I$CBROOT/lib $LLIB ${1+"$@"} 


