#!/home/perl/bin/perl -w
use strict;
use Test::Harness qw(runtests $verbose);
use File::Find;

my $lib = '../lib';
unshift(@INC, $lib);

my @tests = @ARGV; 
my @all_tests;

find(\&wanted, './t/');
sub wanted { 
  return unless m/\.t$/ and -f $_;
  push @all_tests, $File::Find::name;
}

#$ENV{TESTMODE} = 1;

unless (@tests) {
  @tests = @all_tests;
}
else {
  my @args = @tests;
  $verbose = 1 ;
  @tests = ();
  for my $t (@all_tests) {
    push @tests, $t if grep { $t =~ m/\Q$_\E/ } @args;
  }
}

warn "tests: ", join ("|", @tests), "\n";

runtests(@tests);
