<HTML>
<HEAD>
<TITLE>This Week on perl5-porters</TITLE>
<LINK REV="made" HREF="mailto:bhcompile@daffy.perf.redhat.com">
</HEAD>

<BODY>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#this week on perl5porters (410 november 2002)">This Week on perl5-porters (4-10 November 2002)</A></LI>
	<UL>

		<LI><A HREF="#determine whether a scalar is a number">Determine whether a scalar is a number</A></LI>
		<LI><A HREF="#two utf8 bugs">Two UTF8 bugs</A></LI>
		<LI><A HREF="#lexical quandry">Lexical quandry</A></LI>
		<LI><A HREF="#in brief">In brief</A></LI>
		<LI><A HREF="#about this summary">About this summary</A></LI>
	</UL>

</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="this week on perl5porters (410 november 2002)">This Week on perl5-porters (4-10 November 2002)</A></H1>
<P>The usual suspects are once again rounded up. Unicode bugs, PerlIO bugs
and closure bugs are featured in this week's summary. In a sense, that's a
good thing, meaning that the older or more widely used features seem to
work quite well.</P>
<P>
<H2><A NAME="determine whether a scalar is a number">Determine whether a scalar is a number</A></H2>
<P>Slaven Rezic proposed to include a Perl function that hooks to the
internal function <CODE>Perl_looks_like_number()</CODE> in the Scalar::Util module. He
thinks <EM>this would be easier to handle and remember than the regexps
described in perlfaq4.pod, 'How do I determine whether a scalar is a
number...'.</EM> Graham Barr, author of Scalar::Util, found that this was a
good idea, and Slaven sent a patch.</P>
<PRE>
    <A HREF="http://archive.develooper.com/perl5-porters@perl.org/msg88658.html">http://archive.develooper.com/perl5-porters@perl.org/msg88658.html</A>
    <A HREF="http://www.perldoc.com/perl5.8.0/pod/perlapi.html#SV-Manipulation-Functions">http://www.perldoc.com/perl5.8.0/pod/perlapi.html#SV-Manipulation-Functions</A></PRE>
<P>
<H2><A NAME="two utf8 bugs">Two UTF8 bugs</A></H2>
<P>Abhijit Menon-Sen take a look at the bug #18107 reported last week, about
uc(), lc(), <CODE>ucfirst()</CODE> and <CODE>lcfirst()</CODE> not working correctly with <CODE>s///</CODE> on
UTF8 strings. It appeared that this was caused by the unfortunate
interaction of several obscure bugs, on which he worked with Hugo and
others.</P>
<P>Andreas Koenig found a case where Test::ok() reports a success, and
Test::More::ok() reports (incorrectly) a failure (bug #18232).
His test case involves UTF8 strings, captured by a regular expression.
Sadahiro Tomoyuki seems to have found the cause : <EM>SVf_UTF8 of $1 is
dropped off after an inner block</EM>. In other words, the internal UTF8
property of a $&lt;digit&gt; string seems to be incorrectly localized.</P>
<P>
<H2><A NAME="lexical quandry">Lexical quandry</A></H2>
<P>Dave Mitchell began to ask a question about the semantics of <CODE>eval(string)</CODE>
inside closures : what should the following code output ?</P>
<PRE>
    $x = 'global';
    my $x = 'lexical';
    eval q[ sub f { eval '$x' } ];
    my $r = f();
    print &quot;got $r\n&quot;;</PRE>
<P>The thread is not that long, but my brain hurts when I try to summarize
it. Basically Sarathy explained that <CODE>eval()</CODE> has been implemented to be
efficient, but that the implementation could be reworked to do something
that appears to be more correct (i.e. capture the whole lexical context of
the eval()), if an efficient way to do it is worked out. Read all the
details at the archive :</P>
<PRE>
    <A HREF="http://archive.develooper.com/perl5-porters@perl.org/msg88857.html">http://archive.develooper.com/perl5-porters@perl.org/msg88857.html</A></PRE>
<P>Bug #18286 is another demonstration of this same behavior, but with
another bug as well.</P>
<PRE>
    <A HREF="http://archive.develooper.com/perl5-porters@perl.org/msg88895.html">http://archive.develooper.com/perl5-porters@perl.org/msg88895.html</A></PRE>
<P>
<H2><A NAME="in brief">In brief</A></H2>
<P>Rafael Garcia-Suarez applied a fix for the B::* problems reported last
week, and waved hands towards a general direction for a test suite for the
B API.</P>
<P>Chip Turner (who builds the perl that ships on RedHat systems) plans to
build an RPM of perl 5.8.0 that integrates several recent changes,
including some UTF8/PerlIO fixes.</P>
<P>Chip also reported a bug (#18265) related to <CODE>read()</CODE> on nonblocking file
descriptors, which can return undef without setting $!, when PerlIO is
used.</P>
<P>Hugo van der Sanden and Dave Mitchell looked at bug #17920, a core dump
case during the parsing of nested closures containing a syntax error.
Apparently the problem comes from the error recovery logic of the yacc
parser, that shouldn't make any assumption about the erroneous code it
skips.</P>
<P>Brian Ingerson found a way to make perl segfault when using a source
filter, and Slaven Rezic provided a patch.</P>
<P>Nicholas Clark found an interesting way to make xsubpp generate nested C
comments, which is, of course, a bad thing. (Bug #18256.)</P>
<P>Dan Kogai released Encode 1.81, which includes an <EM>ingenious patch by
Nicholas Clark that reduces shlib sizes by 50% with no penalty and
backward compatibility preserved</EM>.</P>
<P>Andreas Koenig reported that character <CODE>\x{df}</CODE>, upgraded to UTF8,
satisfies both the \w and \W regular expression atoms. (Bug #18281.)</P>
<P>Ian Phillipps sent a patch to B::Lint, to have it detect implicitly
quoted bare words that happen to match the name of a subroutine.</P>
<P>The smoke tests (and testers!) helped to discover, hunt down, and fix, a
couple of obscure bugs, again.</P>
<P>
<H2><A NAME="about this summary">About this summary</A></H2>
<P>This summary brought to you by Rafael Garcia-Suarez. It's
also available via a mailing list, which subscription address is
<EM><A HREF="mailto:perl5-summary-subscribe@perl.org">perl5-summary-subscribe@perl.org</A></EM>. Comments and corrections are, as
always, welcome.</P>

</BODY>

</HTML>
