#!/home/perl/bin/perl -w
use strict;
BEGIN { die "CBROOT required" unless $ENV{CBROOT}; }
use lib "$ENV{CBROOT}/lib";
use Getopt::Long;
use Combust::Config;
use Template;

my $config = Combust::Config->new();
#print $config->port, "\n";
#exit;

my $dir = "$ENV{CBROOT}/apache/conf/";

my $tt = new Template({ INCLUDE_PATH => $dir,
                        RELATIVE => 0 
		      }) 
  or die "Error: $Template::ERROR\n"; $Template::ERROR = '' if 0;


my $params = { config => $config,
	       root   => $ENV{CBROOT},
	     };

$params->{dont_edit} = <<EOT;
# ========================================================================
# THIS FILE IS AUTOGENERATED.  DO NOT EDIT.  YOUR CHANGES WILL GO BYE BYE!
# ========================================================================
EOT

# setup $conf/$params for the template

$tt->process("httpd.tmpl", $params, "$dir/httpd.conf")
  or die "Template Error: " . $tt->error();

